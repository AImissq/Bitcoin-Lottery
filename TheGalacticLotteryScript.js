
/*FOR ALL THE GALACTIC FRIENDS OUT.. FUCK THE GALACTIC FEDERATION!!!!/*

********************************************************************************
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMO$$777IIII777$$ZZZ8MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMO$7?==?I7$77$7777777777$ZZONMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMNZ7?~=7$$$$$$$$$$777777777$$77$$ZONMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMO$?:=7$$$$$$$$$$$$$7777777777777$$$$ZO8MMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMO$~,7$$$$$$$$$$$$$$$$$777777777777777$$$ZO8MMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMM$+,$$$$$$$$$$$$$$$$$$$$$77777777777777777$$Z8MMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMM$:?$$$$$$$$$$$$$$$$$$$$$$$777777777777777777$ZODMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMD7,I$$$$$$$$$$$$$$$$$$$$$$$$$777777777777777777$Z8NMMMMMMMMMMMMMMM
MMMMMMMMMMMMMM7,$$$$$$$$$$$$$$$$$$$$$$$$$$$$777777777777777777$Z8NMMMMMMMMMMMMMM
MMMMMMMMMMMMM$:7$$$$$$$$$$$$$$$$$$$$$$$$$$$$7777777777777777777$ODMMMMMMMMMMMMMM
MMMMMMMMMMMMZ+?$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$777777777777777777$ZONMMMMMMMMMMMMM
MMMMMMMMMMMM$~$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$77777777777777777$$ZDMMMMMMMMMMMMM
MMMMMMMMMMMZ+I$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$77777777777777777$Z8NMMMMMMMMMMMM
MMMMMMMMMMM$=$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$77777777777777777$ONMMMMMMMMMMMM
MMMMMMMMMMD$?$ZZZ$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$7$777777777777777$ODMMMMMMMMMMMM
MMMMMMMMMMO77ZZZOOOOZZ$$$$$$$$$$$$$$$$$$$$$$$$$$$7777777$$$$$$777$ZDMMMMMMMMMMMM
MMMMMMMMMMO77ZODNNNND88OZ$$$$$$$$$$$$$$$$$$$$$$$$$7$$$$O88DDDD8Z$$ZDMMMMMMMMMMMM
MMMMMMMMMMO$7ONNMMMMMMND8OZ$$$$$$$$$$$$$$$$$$$$$$$$$O8NNNMMMMMMN8ZZDMMMMMMMMMMMM
MMMMMMMMMMD$ZNMMMMMMMMMMMD8OZ$$$$$$$$$$$$$$$$$$$$$ODNNMMMMMMMMMMN8ZDMMMMMMMMMMMM
MMMMMMMMMMMZ8NMMMMMMMMMMMMM8OZ$$$$$$$$$$$$$$$$$$$ONNMMMMMMMMMMMMM8ZNMMMMMMMMMMMM
MMMMMMMMMMMZ8MMMMMMMMMMMMMMM8OZ$$$$$$$$$$$$$$$$$8NMMMMMMMMMMMMMMM8ZNMMMMMMMMMMMM
MMMMMMMMMMMOONMMMMMMMMMMMMMMMNOZ$$$$$$$$$$$$$$$ONNMMMMMMMMMMMMMMMZ8MMMMMMMMMMMMM
MMMMMMMMMMMNZNMMMMMMMMMMMMMMMMM8Z$$$$$$$$$$$$$8NNMMMMMMMMMMMMMMM87NMMMMMMMMMMMMM
MMMMMMMMMMMMOZNMMMMMMMMMMMMMMMMMOZ$$$$$$$$$$$8NNMMMMMMMMMMMMMMMM$OMMMMMMMMMMMMMM
MMMMMMMMMMMMNZZDMMMMMMMMMMMMMMMMNOZ$$$$$$$$$ONNMMMMMMMMMMMMMMMM$+NMMMMMMMMMMMMMM
MMMMMMMMMMMMMOZ$8NMMMMMMMMMMMMMMM8Z$$$$$$$$ODNMMMMMMMMMMMMMMM$I:DNMMMMMMMMMMMMMM
MMMMMMMMMMMMMMO$$O8DMMMMMMMMMMMMMMOZ$$$$$$ZDNMMMMMMMMMMMMMMD7==8NMMMMMMMMMMMMMMM
MMMMMMMMMMMMMM8Z7$ZO8DMMMMMMMMMMMMNO$$$$$$8NMMMMMMMMMMMMMO7=,7ODNMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMOZ$$$ZO8DMMMMMMMMMMMO$I$$$ODNMMMMMMMMMMMZ7~:7$Z8NMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMO$$$$$$ZO8DMMMMMMMMM$?$$$ODNMMMMMMMM$$=,+$$$$ONNMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMDO$$$$$$$$ZOO8DMMMMN7=$$$O8NMMMMO$I~:+$$$$$$ODNMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMM8Z$$$$$$$$$$$ZZOZZ7=I$$$$$$$7I=~=7$$$$$$$$Z8NMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMOZ$$$$$$$$$$$$$777$$$$$$$$$$$$$$$$$$$$$$$8NMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMNOZ$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ODNMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMDOZ$$$$$$$$$$$$Z888OO8DD8Z$$$$$$$$$$$$ODNMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMM8O$$$$$$$$$$$Z8NMNO8NMMD$$$$$$$$$$$$ODNMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMM8O$$$$$$$$$$ZODDMM$MM87?$$$$$$$$$$ODNMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMM8O$$$$$$$$$$ZZZZ$I7?=+$$$$$$$$$$ZDNMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMM8Z$$$$$$$$$ZZZZ$7$$$$$$$$$$$$ZZDNMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMM8Z$$$$$$ZZDNNNNDDDD8OZZ$$$$ZODNMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMM8Z$$$$$Z8DNMMMMMMMN8Z$$$$ZODNMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMM8O$$$$$$$7777777II$$$$$Z8NNMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMM8OZ$$$$$$$$$$$$$$$$$$Z8NMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMM8OZZ$$$$$$$$$$$$$$$ZDNMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMM8OZ$$$$$$$$$$$$Z8NNMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM88OZ$$$$$$$$ZODNNMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMD8OOZZZZO8DNNMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMNNDDDDNNMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
********************************************************************************

/* PRINT TO DIV FUNCTIONS*/
function print(str){
	$('#myLog').append('<div ></div>');
 	$('#myLog div:last').text(str) ;
 	var objDiv = document.getElementById("myLog");
    objDiv.scrollTop = objDiv.scrollHeight;
 	linecount = linecount+1;
 	if(linecount>100){
 		$("#myLog div").first().remove();
 	}
 	return (linecount);
}

function printN(str){
 	$('#keyCountS').text(str) ;
}

/* TIMER*/
var daysLabel = document.getElementById("days");
var hoursLabel = document.getElementById("hours");
var minutesLabel = document.getElementById("minutes");
var secondsLabel = document.getElementById("seconds");
var totalSeconds = 0;
setInterval(setTime, 1000);
	function setTime() {
 		++totalSeconds;
 		secondsLabel.innerHTML = pad(totalSeconds % 60);
 		var minu = Math.floor(totalSeconds/60);
  		minutesLabel.innerHTML = pad(minu % 60);
  		var hou = Math.floor(totalSeconds/60/60);
  		hoursLabel.innerHTML = pad(hou % 24);
  		daysLabel.innerHTML = pad(parseInt(totalSeconds/ 86400));
	}
	function pad(val) {
  	var valString = val + "";
  		if (valString.length < 2) {
   			return "0" + valString;
  		}
  		else {
    		return valString;
 		 }
	}

/*ELLIPTIC CURVE SECP256K*/
Pcurve = bigInt("115792089237316195423570985008687907853269984665640564039457584007908834671663");
N= bigInt("115792089237316195423570985008687907852837564279074904382605163141518161494337");
Acurve = bigInt("0"); Bcurve = bigInt("7");
Gx = bigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240");
Gy = bigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424");
var GPoint = [Gx,Gy];
var stop = 0;

function modinv(a,n){
    lm  = 1;
    hm = 0;
    low1 = bigInt(a).mod(bigInt(n));
    low2 = bigInt(low1).add(bigInt(n));
    low = bigInt(low2).mod(bigInt(n));
    high = bigInt(n);
    while (bigInt(low).compare(bigInt(1)) == 1){
    	ratio = bigInt(high).divide(bigInt(low));
        nm1 = bigInt(lm).multiply(bigInt(ratio));
        nm = bigInt(hm).subtract(bigInt(nm1));
        new2 = bigInt(low).multiply(bigInt(ratio));
        new1 = bigInt(high).subtract(new2);
        high = bigInt(low);
        hm = bigInt(lm);
        lm = bigInt(nm);
        low = bigInt(new1);
	}
    re1 = bigInt(lm).mod(bigInt(n));
    re2 = bigInt(re1).add(bigInt(n));
    re = bigInt(re2).mod(bigInt(n));
    return (re);
}

function ECadd(a,b){
	b0 = bigInt(b[0]);
	b1 = bigInt(b[1]);
	a0 = bigInt(a[0]);
	a1 = bigInt(a[1]);
	LamAdd1 = bigInt(b1).subtract(bigInt(a1));
	LamAdd2 = bigInt(b0).subtract(bigInt(a0));
	LamAdd3 = modinv(bigInt(LamAdd2),bigInt(Pcurve));
	LamAdd4 = bigInt(LamAdd1).multiply(bigInt(LamAdd3));
	LamAdd5 = bigInt(LamAdd4).mod(bigInt(Pcurve));
	LamAdd6 = bigInt(LamAdd5).add(bigInt(Pcurve));
	LamAdd = bigInt(LamAdd6).mod(bigInt(Pcurve));
	x1 = bigInt(LamAdd).multiply(bigInt(LamAdd));
	x2 = bigInt(x1).subtract(bigInt(a0));
	x3 = bigInt(x2).subtract(bigInt(b0));
	x4 = bigInt(x3).mod(bigInt(Pcurve));
	x5 = bigInt(x4).add(bigInt(Pcurve));
	x = bigInt(x5).mod(bigInt(Pcurve));
	y1 = bigInt(a0).subtract(bigInt(x));
	y2 = bigInt(LamAdd).multiply(bigInt(y1));
	y3 = bigInt(y2).subtract(bigInt(a1));
	y4 = bigInt(y3).mod(bigInt(Pcurve));
	y5 = bigInt(y4).add(bigInt(Pcurve));
	y = bigInt(y5).mod(bigInt(Pcurve));
    return [x,y];
}

function ECdouble(a){
	a0 = bigInt(a[0]);
	a1 = bigInt(a[1]);
	lamA1 =	bigInt(3).multiply(a0);
	lamA2 = bigInt(lamA1).multiply(bigInt(a0));
	lamA3 = bigInt(lamA2).add(bigInt(Acurve));
	lamB1 = bigInt(2).multiply(bigInt(a1));
	lamB2 = modinv(bigInt(lamB1),bigInt(Pcurve));
	lamB3 = bigInt(lamB2).multiply(bigInt(lamA3));
	Lam1 = bigInt(lamB3).mod(bigInt(Pcurve));
	Lam2 = bigInt(Lam1).add(bigInt(Pcurve));
	Lam = bigInt(Lam2).mod(bigInt(Pcurve));
	x1 = bigInt(Lam).multiply(bigInt(Lam));
	x2 = bigInt(2).multiply(bigInt(a[0]));
	x3 = bigInt(x1).subtract(bigInt(x2));
	x4 = bigInt(x3).mod(bigInt(Pcurve));
	x5 = bigInt(x4).add(bigInt(Pcurve));
	x = bigInt(x5).mod(bigInt(Pcurve));
	y1 = bigInt(a[0]).subtract(bigInt(x));
	y2 = bigInt(Lam).multiply(bigInt(y1));
	y3 = bigInt(y2).subtract(bigInt(a[1]));
	y4 = bigInt(y3).mod(bigInt(Pcurve));
	y5 = bigInt(y4).add(bigInt(Pcurve));
	y = bigInt(y5).mod(bigInt(Pcurve));
    return [x,y];
};


function EccMultiply(GenPoint,Scalar){ 
	ScalarSub = bigInt(N).subtract(Scalar);
    if (bigInt(N).compare(Scalar) == -1 || bigInt(Scalar).compare(0) == 0){
    print("Invalid Private Key");
	}
	else{
	ScalarBin = bigInt(Scalar).toString(2);
	var Q=GenPoint;
    var i = 1;
    while (i < ScalarBin.length){
		Q=ECdouble(bigInt(Q));
        if (ScalarBin[i] == "1"){
           Q=ECadd(bigInt(Q),bigInt(GenPoint));
    	 } 
     	var i = i+1;
    }
    return (Q);
    }
}


/*pseudo-random function*/
function randomval(){
	array = new Uint8Array(totalBytesf);
	var crypto = window.crypto || window.msCrypto;
	randomNum =  crypto.getRandomValues(array); 
	var wloop = 1;
	var sumBytes = randomNum[0].toString(16);
	while (bigInt(totalBytesf).subtract(wloop)>0){
		sumBytes = sumBytes.concat(randomNum[wloop].toString(16));
		wloop = bigInt(wloop).add(1);
	}
	window.sumBytesf=sumBytes;
}


/*PRIVATE KEY DEC2WIF*/
function privDec2Wif(dec){
	privBin= dec.toString(2);
	prifix = "10000000";
	prepend0a= 256-privBin.length;
	prepend0b= prifix.concat(Array(prepend0a + 1).join("0"),privBin);
	bin2Hex= bigInt(prepend0b, 2).toString(16);
	binDecode= hex2a(bin2Hex);
	sha256x1 = SHA256(binDecode);
	binDecodesha= hex2a(sha256x1);
	sha256x2 = SHA256(binDecodesha);
	checksum = sha256x2.substr(0, 8);
	prewif= bin2Hex.concat(checksum);
	privWif = enc64_58(prewif);

 return (privWif);
}


/*START FUNCTION*/
function start1(){
	blockSize  = bigInt("100");
	blocklimit = bigInt(N).divide(blockSize);
	blocklimitHex = blocklimit.toString(16);
	totalBytes = blocklimit.toString(16).length;
	if (totalBytes % 2 == 0){
		totalBytesf= (totalBytes)/2;
		firstByte = blocklimitHex.charAt(0)+blocklimitHex.charAt(1);
		firstByte1 = parseInt(firstByte, 16);
		priHex = (Math.floor(Math.random() * firstByte1) + 0).toString(16);
	}
	else{
		totalBytesf =(totalBytes-1)/2;
		firstByte = blocklimitHex.charAt(0);
		firstByte1 = parseInt(firstByte, 16);
		priHex = (Math.floor(Math.random() * firstByte1) + 0).toString(16);	
	}
	randomval(totalBytesf);
	userInputHex = priHex.concat(sumBytesf);
	userInput = bigInt(userInputHex,16); 
	if (bigInt(userInput).subtract(blocklimit)>0){
		start1();
	} 
	else {
		blockNumber = userInput;
	}
}


/*MAIN FUNCTION*/
function hashing(){
	start1()
	var loopCount = blockSize;
	startRangeMul = bigInt(blockNumber).multiply(blockSize);
	startRange = bigInt(startRangeMul).add("1");
	endRange =bigInt(startRange).add(blockSize);
	var key = startRange;
	var y =0;
	print("******************************************************************");
	var sVar = setInterval(function(){
		if (loopCount<1 && y<1) {
			clearInterval(sVar);
			hashing();
		}
		PublicKey = EccMultiply(bigInt(GPoint),bigInt(key));
		uncompress = "04" + bigInt(PublicKey[0]).toString(16) + PublicKey[1].toString(16);
    	uncompressbin = hex2a(uncompress);
    	outputsha256 = SHA256(uncompressbin);	
    	outbin = hex2a(outputsha256);
    	outputripemd160 = RMDstring(outbin);	
		if (satoshiKeys.indexOf(outputripemd160) != -1){
    		lr = bigInt(key);
    		lt = "It's a Match!!!!!!";
    		text= "Private Key Decimal: ";
    		text1= "Private Key WIF: ";
    		y = y+1;
    		print("*********************************************************");
			print(lt);
			print(text.concat(lr));
			print(text1.concat(privDec2Wif(bigInt(key))));
			clearInterval(sVar);
    	}
    	else{
    		lr = bigInt(key);
    		lt = "No Match!";
       		n= n+1;
       		text= "Private Key Decimal: ";
			text1= "Public Key Hex: ";
    		print(text.concat(lr));
    		print(text1.concat(outputripemd160));
    		print(lt);
    		print(".");
    		printN(n);
    	}
		key = bigInt(key).add("1");
		loopCount = bigInt(loopCount).subtract("1");
		return [key,loopCount,y,n];
	},0);
};


/*TRIGGER*/
var linecount = 0;
var n =0;
hashing();




